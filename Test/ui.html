<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Figma Plugin UI</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
    input, button { margin: 5px; padding: 10px; }
    #loader {
      display: none;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h3>Create Rectangle</h3>

  <label for="width">Width:</label>
  <input type="number" id="width" value="150" /><br>

  <label for="height">Height:</label>
  <input type="number" id="height" value="200" /><br>

  <label for="color">Color:</label>
  <input type="color" id="color" value="#7f7fff" /><br>

  <button id="create-rect">Create Rectangle</button>
  
  <!-- Simple text loader -->
  <div id="loader">Loading... Please wait.</div>

  <script>
    // Handle button click
    document.getElementById('create-rect').onclick = () => {
      const width = parseInt(document.getElementById('width').value);
      const height = parseInt(document.getElementById('height').value);
      const colorHex = document.getElementById('color').value;

      // Convert hex color to RGB
      const r = parseInt(colorHex.slice(1, 3), 16) / 255;
      const g = parseInt(colorHex.slice(3, 5), 16) / 255;
      const b = parseInt(colorHex.slice(5, 7), 16) / 255;

      // Show loader, hide the button
      document.getElementById('loader').style.display = 'block';
      document.getElementById('create-rect').style.display = 'none';

      // Send message to the plugin code with the parameters
      parent.postMessage({
        pluginMessage: {
          type: 'create-rect',
          width: width,
          height: height,
          color: { r: r, g: g, b: b }
        }
      }, '*');
    };

    // Listen for message from code.js to stop the loader
    window.onmessage = (event) => {
      if (event.data.pluginMessage === 'done') {
        // Hide loader, show the button again
        document.getElementById('loader').style.display = 'none';
        document.getElementById('create-rect').style.display = 'inline-block';
      }
    };
  </script>
</body>
</html>
